import streamlit as st
from google import genai
import os

st.set_page_config(page_title="–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–ª—é—á–∞", layout="centered")
st.title("üõ† –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π")

try:
    api_key = st.secrets["GOOGLE_API_KEY"]
except:
    st.error("–ù–µ—Ç –∫–ª—é—á–∞ –≤ —Å–µ–∫—Ä–µ—Ç–∞—Ö!")
    st.stop()

client = genai.Client(api_key=api_key)

if st.button("üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–π –∫–ª—é—á"):
    st.info("–ó–∞–ø—Ä–∞—à–∏–≤–∞—é —Å–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π, –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤–∞—à–µ–º—É –∞–∫–∫–∞—É–Ω—Ç—É...")
    
    try:
        # –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π
        all_models = list(client.models.list())
        
        # –ò—â–µ–º —Å—Ä–µ–¥–∏ –Ω–∏—Ö —Ç–µ, —á—Ç–æ —É–º–µ—é—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫–∏
        imagen_models = [m.name for m in all_models if "imagen" in m.name or "image" in m.name]
        
        if imagen_models:
            st.success(f"‚úÖ –£—Ä–∞! –ù–∞–π–¥–µ–Ω—ã –º–æ–¥–µ–ª–∏ –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–æ–∫ ({len(imagen_models)} —à—Ç.):")
            for m in imagen_models:
                st.code(m)
            st.markdown("---")
            st.write("–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `imagen-2.0` –∏–ª–∏ –ø–æ—Ö–æ–∂–µ–µ) –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –µ–≥–æ –≤ –ø—Ä–æ—à–ª—ã–π –∫–æ–¥ –≤–º–µ—Å—Ç–æ `imagen-3.0-generate-001`.")
        else:
            st.error("‚ùå –ú–æ–¥–µ–ª–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–∞—Ä—Ç–∏–Ω–æ–∫ (Imagen) –ù–ï –Ω–∞–π–¥–µ–Ω—ã.")
            st.warning("""
            **–ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?**
            –°–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, —É –≤–∞—Å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∫–ª—é—á (Free Tier) –±–µ–∑ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω–æ–π –∫–∞—Ä—Ç—ã.
            
            **–ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:**
            1. –ó–∞–π–¥–∏—Ç–µ –≤ [Google Cloud Console](https://console.cloud.google.com/).
            2. –í—ã–±–µ—Ä–∏—Ç–µ —Å–≤–æ–π –ø—Ä–æ–µ–∫—Ç.
            3. –í–∫–ª—é—á–∏—Ç–µ **Billing** (–ø—Ä–∏–≤—è–∂–∏—Ç–µ –∫–∞—Ä—Ç—É). –≠—Ç–æ –ø–µ—Ä–µ–≤–µ–¥–µ—Ç –≤–∞—Å –Ω–∞ —Ç–∞—Ä–∏—Ñ "Pay-as-you-go", –∏ –º–æ–¥–µ–ª–∏ Imagen –æ—Ç–∫—Ä–æ—é—Ç—Å—è.
            """)
            
            st.write("–°–ø–∏—Å–æ–∫ –≤–æ–æ–±—â–µ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤–∞–º –º–æ–¥–µ–ª–µ–π (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏):")
            st.json([m.name for m in all_models])

    except Exception as e:
        st.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ: {e}")
